divPalette <- function (n, name = c("BrBG", "PiYG", "PRGn", "PuOr", "RdBu",
                           "RdGy", "RdYlBu", "RdYlGn", "Spectral"))
                       {
                           BrBG = rgb(c(84, 140, 191, 223, 246, 245, 199, 128, 53, 1,
                               0), c(48, 81, 129, 194, 232, 245, 234, 205, 151, 102,
                               60), c(5, 10, 45, 125, 195, 245, 229, 193, 143, 94, 48),
                               maxColorValue = 255)
                           PiYG = rgb(c(142, 197, 222, 241, 253, 247, 230, 184, 127,
                               77, 39), c(1, 27, 119, 182, 224, 247, 245, 225, 188,
                               146, 100), c(82, 125, 174, 218, 239, 247, 208, 134, 65,
                               33, 25), maxColorValue = 255)
                           PRGn = rgb(c(64, 118, 153, 194, 231, 247, 217, 166, 90, 27,
                               0), c(0, 42, 112, 165, 212, 247, 240, 219, 174, 120,
                               68), c(75, 131, 171, 207, 232, 247, 211, 160, 97, 55,
                               27), maxColorValue = 255)
                           PuOr = rgb(c(127, 179, 224, 253, 254, 247, 216, 178, 128,
                               84, 45), c(59, 88, 130, 184, 224, 247, 218, 171, 115,
                               39, 0), c(8, 6, 20, 99, 182, 247, 235, 210, 172, 136,
                               75), maxColorValue = 255)
                           RdBu = rgb(c(103, 178, 214, 244, 253, 247, 209, 146, 67,
                               33, 5), c(0, 24, 96, 165, 219, 247, 229, 197, 147, 102,
                               48), c(31, 43, 77, 130, 199, 247, 240, 222, 195, 172,
                               97), maxColorValue = 255)
                           RdGy = rgb(c(103, 178, 214, 244, 253, 255, 224, 186, 135,
                               77, 26), c(0, 24, 96, 165, 219, 255, 224, 186, 135, 77,
                               26), c(31, 43, 77, 130, 199, 255, 224, 186, 135, 77,
                               26), maxColorValue = 255)
                           RdYlBu = rgb(c(165, 215, 244, 253, 254, 255, 224, 171, 116,
                               69, 49), c(0, 48, 109, 174, 224, 255, 243, 217, 173,
                               117, 54), c(38, 39, 67, 97, 144, 191, 248, 233, 209,
                               180, 149), maxColorValue = 255)
                           RdYlGn = rgb(c(165, 215, 244, 253, 254, 255, 217, 166, 102,
                               26, 0), c(0, 48, 109, 174, 224, 255, 239, 217, 189, 152,
                               104), c(38, 39, 67, 97, 139, 191, 139, 106, 99, 80, 55),
                               maxColorValue = 255)
                           Spectral = rgb(c(158, 213, 244, 253, 254, 255, 230, 171,
                               102, 50, 94), c(1, 62, 109, 174, 224, 255, 245, 221,
                               194, 136, 79), c(66, 79, 67, 97, 139, 191, 152, 164,
                               165, 189, 162), maxColorValue = 255)
                           name = match.arg(name)
                           orig = eval(parse(text = name))
                           rgb = t(col2rgb(orig))
                           temp = matrix(NA, ncol = 3, nrow = n)
                           x = seq(0, 1, , length(orig))
                           xg = seq(0, 1, , n)
                           for (k in 1:3) {
                               hold = spline(x, rgb[, k], n = n)$y
                               hold[hold < 0] = 0
                               hold[hold > 255] = 255
                               temp[, k] = round(hold)
                           }
                           palette = rgb(temp[, 1], temp[, 2], temp[, 3], maxColorValue = 255)
                           palette
}
